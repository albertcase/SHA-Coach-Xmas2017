"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1),function(t){function e(t,e,i){this.duration=t,this.update=e,this.easing=i}function i(t){this.animators=t||[]}e.prototype={req:null,start:function(t){function e(){var t=(Date.now()-i)/n;if(t<1)s.call(h,a?a(t):t,t),h.req=requestAnimationFrame(e);else{("function"==typeof r?!1===r.call(h):!1===r)?(t-=1,i+=n,e(a&&a(t))):s.call(h,a?a(1):1,1)}}t=t||{};var i=Date.now(),n=this.duration,s=this.update,a=this.easing,o=t.begin,r=t.end,h=this;o&&o.call(this),h.req=requestAnimationFrame(e)},pause:function(){window.cancelAnimationFrame(this.req)}},i.prototype={append:function(){var t=[].slice.call(arguments);this.animators.push.apply(this.animators,t)},flush:function(){function t(){var n=i.animators.shift();n instanceof e?n.start({end:function(){i.animators.length&&t()}}):(n.call(i),i.animators.length&&t())}if(this.animators.length){var i=this;t()}}},t.AnimationQueue=i,t.Animator=e}(window),function(t){function e(){this.el=null,this.width=null,this.height=null,this.x=0,this.y=62,this.latex=0,this.latey=0,this.parentEl=document.getElementById("scene"),this.speed=20,this.keyCode=["37","38","39","40","32"],this.animators=new AnimationQueue,this.status="paused",this.jump={count:0,first:0,end:0},this.common=new Common,this.elClassName=null,this.isEat=0,this.waitStatus=0}e.prototype={init:function(){this.create(),this.render(),this.el.style.cssText="left: "+this.x+"px; top: "+this.y+"%",this.bind()},render:function(){var e=parseInt(t.getComputedStyle(this.parentEl).width,10);this.el=document.getElementById("hero"),this.x=Math.floor(.2*e),this.width=parseInt(t.getComputedStyle(this.el).width,10),this.height=parseInt(t.getComputedStyle(this.el).height,10)},create:function(){var t=document.createElement("div");t.id="hero",t.className="hero "+this.elClassName,this.parentEl.appendChild(t)},left:function(){this.latex-=this.speed,this.update()},right:function(){this.latex+=this.speed,this.update()},update:function(){this.el.style.transform="translate("+this.latex+"px, "+this.latey+"px)"},anim:function(){if("play"!==this.status&&!this.waitStatus){this.status="play",magicFun.paused=0;var t=this;barriers.speed=8;var e=new Animator(300,function(e){var i=170-170*(1-e);t.latey=-i,t.update()}),i=new Animator(500,function(e){var i=-170*(1-e);t.latey=i,t.update()});t.animators.append(e,i,function(){t.status="paused",t.isEat=0,barriers.speed=6}),t.animators.flush()}},jumpMobile:function(t){var e=this;e.jump.count++,2==e.jump.count&&(e.jump.first=t),e.jump.count>=5&&(e.jump.end=t,e.jump.first>e.jump.end&&e.jump.first-e.jump.end>5&&hero.anim(),e.jump.count=0,e.jump.first=0,e.jump.end=0)},handleOrientation:function(t){t.absolute,t.alpha,t.beta;var e=Math.floor(t.gamma);this.jumpMobile(Math.abs(e))},bind:function(){var e=this;document.onkeydown=function(i){var n=(i=i||t.event).keyCode||i.which||i.charCode;if(i.shiftKey)if(n==e.keyCode[0]){if(magicFun.paused)return;console.log("左")}else if(n==e.keyCode[2]){if(magicFun.paused)return;console.log("右")}else n==e.keyCode[3]?console.log("下"):n!=e.keyCode[1]&&n!=e.keyCode[4]||e.anim()},t.addEventListener("deviceorientation",e.handleOrientation.bind(e),!0)},exit:function(){this.el.className+=" mvExit"},waitAnimate:function(){var t=.2,e=this;e.waitStatus=1;var i=setInterval(function(){!function(){t>=.9?(e.waitStatus=0,clearTimeout(i),e.el.className+=" shake"):t+=.1;var n=parseFloat(t).toFixed(1),s=10*n-10;e.el.style.opacity=n,e.el.style.transform="translateX("+s+"px)"}()},60)}},t.hero=new e}(window),function(t){function e(){this.parentEl=document.getElementById("scene"),this.cname="style1",this.x=0,this.y=59,this.width=null,this.height=null,this.elements=[],this.speed=6,this.hero=null}e.prototype.init=function(){this.render();var e=document.createElement("div");return e.className="coachPro "+this.cname,e.style.cssText="left: "+this.x+"px; top: "+this.y+"%",this.parentEl.appendChild(e),this.width=parseInt(t.getComputedStyle(e).width,10),this.height=parseInt(t.getComputedStyle(e).height,10),e},e.prototype.render=function(){this.x=parseInt(t.getComputedStyle(this.parentEl).width,10),this.hero=hero},e.prototype.doing=function(t){var e=null;t%80==0&&(e=this.init()),e&&this.elements.push(e);for(var i=0;i<this.elements.length;i++)this.update(this.elements[i],i)},e.prototype.update=function(t,e){var i=parseInt(t.style.left,10)-this.speed,n=this.hero.latex+this.hero.x,s=(this.hero.latey,Math.floor(.8*this.hero.width));i>n-.6*s&&i<n+s&&"paused"===this.hero.status?(this.hero.waitAnimate(),magicFun.paused=1,i=n+s,this.hero.el.style.opacity=.2,this.hero.el.style.transform="translateX(-10px)"):this.hero.el.className=this.hero.el.className.replace(" shake",""),i<-s&&(t.style.opacity=.1,t.remove(),this.elements.splice(e,1),i=null),t.style.left=i+"px"},t.barriers=new e}(window),function(t){function e(t,e,i){this.speed=0===e?6:e,this.x=t,this.className=i}var i=[{className:["el-4","el-5","el-6","el-3","el-1","el-2"],rate:["0","90","80","180","50","100","167"]},{className:["el2-1","el2-2","el2-3","el2-4","el2-5","el2-6"],rate:["0","100","100","180","50","90","127"]},{className:["el3-1","el3-2","el3-3","el3-4","el3-5","el3-6"],rate:["0","90","80","150","180","50","167"]},{className:["el4-1","el4-2","el4-3","el4-4","el4-5","el4-6"],rate:["0","90","80","180","90","60","167"]}];e.prototype={draw:function(t){var e=document.createElement("div");e.className="el "+this.className,e.style.left=this.x+"px",t.appendChild(e)},move:function(){this.x+=this.speed}};var n={scene:document.getElementById("scene"),sceneWidth:0,sceneHeight:0,timer:null,count:0,elements:[],parentEl:document.querySelector(".element"),abc:0,elDataArrayIndex:0,elDataArray:null,speed:1,setTime:5,waitCount:0,initX:-160,init:function(){this.render()},render:function(){this.sceneWidth=parseInt(t.getComputedStyle(this.scene).width,10),this.sceneHeight=parseInt(t.getComputedStyle(this.scene).height,10),this.update()},update:function(){this.timer=setInterval(this.loop,this.setTime)},paused:function(){clearInterval(this.timer),this.timer=null},draw:function(){var t=n;t.parentEl.innerHTML="";for(var e=0;e<t.elements.length;e++){var i=t.elements[e];i.x>t.sceneWidth+180||i.x<-180?t.elements.splice(e,1):i.draw(t.parentEl)}},loop:function(){var t=n;if(magicFun.paused)return!1;t.elDataArray=i[t.elDataArrayIndex];var s=t.initX,a=t.elDataArray.rate[t.abc]?t.elDataArray.rate[t.abc]:15;t.wait(a,function(){t.abc>6&&(t.abc=0,t.count=0);var i=new e(s,t.speed,t.elDataArray.className[t.abc]);t.elements.push(i),t.abc++});for(var o=0;o<t.elements.length;o++)t.elements[o].move();t.draw(),t.count++},wait:function(t,e){this.waitCount++,this.waitCount>=t&&(this.waitCount=0,e())}};t.elementsObj=n}(window),function(t){function e(){this.parentEl=document.getElementById("scene"),this.cname="style1",this.x=0,this.y=38,this.width=0,this.height=0,this.elements=[],this.speed=4,this.eatScores=[],this.hero=null,this.heroId=0,this.eatMusic=null,this.enterSpace=0}var i=[{key:2,style:""},{key:56,style:"style2"},{key:150,style:"style3"},{key:220,style:""},{key:300,style:"style2"},{key:410,style:"style1"},{key:500,style:"style3"}];e.prototype.init=function(){this.render();var e=document.createElement("div");return e.className="heart "+this.cname,e.style.cssText="left: "+this.x+"px; top: "+this.y+"%;",e.setAttribute("data-id",this.heroId),this.parentEl.appendChild(e),this.width=parseInt(t.getComputedStyle(e).width,10),this.height=parseInt(t.getComputedStyle(e).height,10),e},e.prototype.render=function(){this.eatMusic=document.getElementById("eatMusic"),this.x=parseInt(t.getComputedStyle(this.parentEl).width,10),this.hero=hero},e.prototype.doing=function(t){var e=null,n=Math.floor(100*Math.random());this.enterSpace++,this.heroId<=40&&(t%100!=0&&n%50!=0||this.elements.length<=3&&this.enterSpace>=12&&(this.enterSpace=0,this.heroId++,e=this.init(i[0].style))),e&&this.elements.push(e);for(var s=0;s<this.elements.length;s++)this.update(this.elements[s],s)},e.prototype.update=function(t,e){var i=parseInt(t.style.left,10)-this.speed,n=(parseInt(t.style.top,10),this.hero.latex+this.hero.x),s=-1*this.hero.latey,a=Math.floor(.6*this.hero.width);if(i>n&&i<n+a&&this.hero.y-s<this.y){var o=t.getAttribute("data-id");this.eatScores.indexOf(o)<0&&(this.eatScores.push(t.getAttribute("data-id")),this.eatMusic.currentTime=0,this.eatMusic.play()),this.hero.isEat=1,t.style.opacity=.1,t.remove(),i=null}i<-a&&(t.remove(),this.elements.splice(e,1),i=null),t.style.left=i+"px"},window.star=new e}(window),function(t){function e(){if(!(this instanceof e)){var t=new e;return t.init(),t}this.el=null,this.init=function(){this.create()},this.create=function(){var t=document.createElement("audio");t.src="/build/dist/media/coachxmas.m4a",t.loop=!0,t.preload="auto",t.innerHTML="您的浏览器不支持 audio 标签。",this.el=t,document.body.appendChild(t)},this.play=function(){this.el.play()},this.pause=function(){this.el.pause()}}function i(){this.timer=null,this.paused=0,this.countInit=0,this.sceneHover=null,this.common=new Common,this.status=0}var n=e(),s=new function(t){return{data:{el:document.querySelector(t),timer:null,count:0,minutes:0,second:0},init:function(){this.update()},update:function(){this.data.minutes=this.data.count%60+"",this.data.second=Math.floor(this.data.count/60)+"",this.data.el.innerHTML='<div class="timePos n'+(this.data.second<10?"0":this.data.second[0])+'"></div><div class="timePos n'+(this.data.second<10?this.data.second:this.data.second[1])+'"></div><div class="timePos n10"></div><div class="timePos n'+(this.data.minutes<10?"0":this.data.minutes[0])+'"></div><div class="timePos n'+(this.data.minutes<10?this.data.minutes:this.data.minutes[1])+'"></div>',this.data.count++},start:function(){var t=this;t.data.timer=setInterval(function(){t.update()},1e3)},paused:function(){clearInterval(this.data.timer)},getTime:function(){return{second:this.data.second<10?"0"+this.data.second:this.data.second,minutes:this.data.minutes<10?"0"+this.data.minutes:this.data.minutes}}}}(".timeArea");i.prototype.init=function(){this.sceneHover=document.querySelector(".scene-bg.hover"),this.open(),s.start()},i.prototype.open=function(){if(this.paused||this.update(),this.status)window.cancelAnimationFrame(this.timer),this.timer=null;else{this.timer=t.requestAnimationFrame(this.open.bind(this));var e=document.querySelector(".iknow-btn");e.className=e.className.replace(" disabled","")}},i.prototype.update=function(){var e=this.countInit;switch(e){case 2:this.sceneBgChange(".scene1",0,"style1");break;case 500:this.sceneBgChange(".scene2",1,"style2");break;case 1e3:this.sceneBgChange(".scene3",2,"style3");break;case 1500:this.sceneBgChange(".scene4",3,"style4");break;case 2e3:this.status=1,t.removeEventListener("deviceorientation",function(){},!0),document.onkeyup=null,elementsObj.paused(),s.paused(),this.countInit=null,this.count()}this.countInit++,barriers.doing(e),star.doing(e)},i.prototype.cancelStatus=function(){t.cancelAnimationFrame(this.timer)},i.prototype.sceneBgChange=function(t,e,i){var n=this;elementsObj.elDataArrayIndex=e,barriers.cname=i;var s=document.querySelector(t);$(s).transition({opacity:1,duration:500,easing:["cubic-bezier(.42,0,1,1)"],complete:function(){$(this).addClass("hover"),$(n.sceneHover).transition({opacity:0,duration:100,easing:"out",complete:function(){$(this).removeClass("hover")}})}})},i.prototype.count=function(){var t=this;n.pause();var e=s.getTime(),i=star.eatScores.unique();hero.exit(),document.getElementById("hero").addEventListener("webkitAnimationEnd",function(n){var s=document.querySelector(".loading");s.className="loading",s.style.visibility="visible",s.querySelector("p").innerHTML="目前涌入的小伙伴过多<br>成绩正在计算中，请耐心等待。";var a=Math.round(60*e.second+1*e.minutes-.5*i.length),o=Math.floor(1e3*Math.random());t.common.fetch.record({records:a+"."+o,animal:hero.elClassName,bar:i.length,timeinit:60*e.second+1*e.minutes},function(e){3===e.status&&t.common.base.formErrorTips(e.msg),document.querySelector(".heartCount").innerHTML=i.length+" 个",document.querySelector(".timeCount").innerHTML=Math.floor(a/60)+" 分 "+a%60+" 秒 "+o,t.common.PageRouter("scores"),s.className="loading hidden",s.style.visibility="hidden",s.querySelector("p").innerHTML="目前涌入的小伙伴过多<br>页面正在跳转中，请耐心等待。",shareData._title="酷玩圣诞，“礼”享不停！",shareData._desc="这里有一份圣诞惊喜正在等你领取！",shareData._desc_friend="这里有一份圣诞惊喜正在等你领取！",shareData._link=e.share_url,shareData._shareAppMessageCallback=function(){t.common.PageRouter("share"),shareTips.hide(),_hmt.push(["_trackEvent","share","button","onMenuShareAppMessage - result"])},shareData._shareTimelineCallback=function(){t.common.PageRouter("share"),shareTips.hide(),_hmt.push(["_trackEvent","share","button","onMenuShareTimeline - result"])},t.common.base.wxshareFun()})})};var a=document.querySelector(".iknow-btn");t.magicFun=new i,a.addEventListener("click",function(){if(this.className.indexOf(" disabled")>=0)return!1;this.className+=" disabled",$(".gameTips").hide(),n.play(),elementsObj.init(),s.init(),hero.init(),barriers.init(),star.init(),magicFun.init()},!1)}(window),function(t){window.shareTips=new function(t){return{init:function(){this.render()},datas:{el:null,close:null},render:function(){this.datas.el=$(t),this.datas.close=$(t).find(".close"),this.bind()},bind:function(){var t=this;t.datas.close.on("click",function(){t.hide()})},show:function(){this.datas.el.removeClass("hidden")},hide:function(){this.datas.el.addClass("hidden")}}}(".shareTips"),shareTips.init()}();